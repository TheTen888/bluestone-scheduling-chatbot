# Healthcare Provider Scheduling System

Healthcare optimization platform for provider scheduling across multi-facility networks.

## Overview
- **Multi-objective optimization** using OR-Tools solver for scalable provider scheduling
- **Real-world deployment** supporting provider networks with custom distance matrices
- **Constraint frameworks** including facility visit gap constraints, workload balancing, and sliding window scheduling
- **Interactive analytics** with real-time travel time calculations and persistent state management
- **Data-driven scheduling** with flexible data import and optimization result export

## Quick Setup

### Prerequisites
- Python 3.9+ (tested with 3.12)
- Node.js 16+ and npm
- **Optimization Solver**: OR-Tools (open source)

### Backend Setup

1. **Create Python environment**:
   ```bash
   conda create -n bluestone python=3.12
   ```
   - Creates a new conda environment named "bluestone"

2. **Activate the environment**:
   ```bash
   conda activate bluestone
   ```
   - You should see `(bluestone)` in your terminal prompt

3. **Install Python dependencies**:
   ```bash
   pip install -r requirements.txt
   ```
   - Installs Flask, OR-Tools, NumPy, etc.

4. **Verify installation**:
   ```bash
   python -c "import ortools; print('OR-Tools installed successfully')"
   ```

### Frontend Setup

1. **Navigate to frontend directory**:
   ```bash
   cd frontend
   ```

2. **Install Node.js dependencies**:
   ```bash
   npm install
   ```
   - Downloads and installs all React dependencies
   - This may take a few minutes

## Data Configuration

**⚠️ SIMPLE SETUP: Just create a `data/real/` directory with your data**

1. **Create your data directory**:
   ```bash
   mkdir -p data/real/distance_matrices
   ```

2. **Add your organization's data files**:
   - `data/real/PCP_Facility.csv` - Provider-facility relationships and patient assignments
   - `data/real/Census.csv` - Monthly patient census data by facility  
   - `data/real/PCP_Visits.csv` - Historical visit records
   - `data/real/distance_matrices/[BusinessLine]_pcp_facility_durations.csv` - Travel times from provider homes to facilities
   - `data/real/distance_matrices/[BusinessLine]_facility_facility_durations.csv` - Inter-facility travel times

   **Business Line Specific (To ensure each facility is taken care by one provider):**
   - `data/real/[BusinessLine]_assignments.csv` - Valid provider-facility pairs for filtering (e.g., `Wisconsin_Geriatrics_assignments.csv`)

3. **Switch to your data** by editing `models/config.py`:
   ```python
   data_source = "real"  # Change from "anonymized" to "real"
   ```

4. **Copy data for web interface**:
   ```bash
   cp data/real/*.csv frontend/public/
   cp -r data/real/distance_matrices frontend/public/
   ```

**Optional Files:**
- `data/provider_unavailable_dates.csv` - Provider vacation/unavailable dates

### Output Files (Generated by System)
- `results/schedules/*.json` - Saved optimization results in structured JSON format for future system integration

## How to Run the System

### Method 1: Separate Terminals (Recommended for Development)

**Use this method when you need to see console logs and debug issues**

1. **Start the Backend Server** (Terminal 1):
   ```bash
   python app.py
   ```
   - Flask backend runs at: http://127.0.0.1:5001
   - Shows API logs and optimization progress
   - Keep this terminal open

2. **Start the Frontend Server** (Terminal 2):
   ```bash
   cd frontend
   npm start
   ```
   - React frontend runs at: http://localhost:3000
   - Browser opens automatically
   - Shows build logs and any errors
   - Keep this terminal open

3. **Access the Application**: 
   - Open browser to: http://localhost:3000
   - The frontend automatically connects to the backend

### Method 2: Quick Start (Background Services)

**Use this for local development and testing**

1. **One-command startup**:
   ```bash
   ./start.sh
   ```
   - Starts both backend and frontend
   - Access at: http://localhost:3000
   - Services run in background

2. **Stop all services**: Press `Ctrl+C` in the terminal

### Important Notes

- **Backend**: Flask runs on port 5001
- **Frontend**: React runs on port 3000 (development only)
- **Access**: Open browser to http://localhost:3000

## What This System Does

**Automatically creates optimal provider schedules that:**
- **Minimize travel time and costs** - Reduces provider driving between facilities
- **Balance workloads fairly** - Ensures no provider is overloaded while others are underutilized  
- **Maintain facility coverage** - Guarantees all facilities receive regular provider visits
- **Handle real-world constraints** - Accounts for provider availability and facility requirements

## How to Use

1. **Upload your data** - Provider locations, facility locations, patient census
2. **Configure optimization** - Set workload limits, visit frequency requirements
3. **Run optimization** - System generates optimal schedules in minutes
4. **Review results** - View schedules, travel times, and workload distribution
5. **Export schedules** - Save results for implementation in your existing systems

## Project Structure

```
├── app.py                          # Flask API server (main entry point)
├── requirements.txt                # Python dependencies  
├── start.sh                        # Quick startup script
├── models/                         # Optimization engine
│   ├── config.py                  # System configuration and data paths
│   ├── dataloader.py              # Data loading and processing
│   └── ortools_travel_optimized_model.py  # Main OR-Tools optimization model
├── frontend/                       # React web application
│   ├── src/                       # React source code
│   │   ├── App.js                 # Main React component
│   │   ├── api.js                 # API calls to Flask backend
│   │   └── components/            # UI components (ConfigPanel, CalendarView)
│   ├── public/                    # Static assets and data files
│   │   ├── *.csv                  # Your organization's data files
│   │   └── distance_matrices/  # Travel time matrices
│   └── package.json               # Node.js dependencies and scripts
├── utils/                          # Processing utilities
│   ├── business_line_optimize_ortools.py  # Business line optimization
│   ├── quick_optimize_ortools.py  # Single provider optimization
│   └── optimal_travel_calculator.py  # Travel time calculations
├── data/                           # Data directories
│   ├── anonymized/                # Sample data (for testing)
│   ├── real/                      # Your organization's data (created by you)
│   └── provider_unavailable_dates.csv  # Provider availability data
└── results/                        # Generated outputs
    └── schedules/                 # Optimization results in JSON format for API integration
```

## Tech Stack

### Backend
- **Python 3.12** with Flask RESTful API
- **Optimization**: OR-Tools (open source)
- **Data Processing**: NumPy, Pandas for healthcare data analysis

### Frontend  
- **React 18** with modern hooks and functional components
- **State Management**: Persistent filters and analytics across navigation
- **UI Components**: Interactive calendar views, real-time statistics panels
- **Data Visualization**: Schedule calendars, travel time analytics, provider utilization

### Infrastructure
- **Local Development**: Flask dev server with React hot reload
- **Data Handling**: CSV file processing with flexible schema support
- **File Export**: JSON results storage with structured format for external system integration

## Maintenance Notes

### Regular Tasks
- **Data Updates**: Update CSV files in `data/real/` with current data

### Troubleshooting
- **Port Conflicts**: Change ports in `package.json` (frontend) or `app.py` (backend) if needed
- **Data Errors**: Verify CSV file formats match expected schema
- **Optimization Failures**: Check provider availability data and constraint parameters
